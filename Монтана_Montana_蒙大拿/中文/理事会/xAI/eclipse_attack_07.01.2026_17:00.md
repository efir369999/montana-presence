# ECLIPSE ATTACK –ù–ê –°–ï–¢–¨ MONTANA - –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó

**–ú–æ–¥–µ–ª—å:** Grok 3
**–ö–æ–º–ø–∞–Ω–∏—è:** xAI
**–î–∞—Ç–∞:** 07.01.2026 17:00 UTC

## –í–í–ï–î–ï–ù–ò–ï

–ü—Ä–æ–≤–µ–¥–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Å–ª–æ—è Montana –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Eclipse Attack —Å–æ–≥–ª–∞—Å–Ω–æ —à–∞–±–ª–æ–Ω—É –∏–∑ `PROMPT_COUNSIL_TEMPLATE.md`. –ê–Ω–∞–ª–∏–∑ –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Å–µ—Ö —Ç—Ä–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤: netgroup diversity –¥–ª—è outbound, anchor connections, –∏ bucket collision handling.

## –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ù–ê–•–û–î–ö–ê: ECLIPSE ATTACK –í–û–ó–ú–û–ñ–ï–ù

**–°—Ç–∞—Ç—É—Å:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨ - ECLIPSE ATTACK –†–ï–ê–õ–ò–ó–£–ï–ú**

## –ê–ù–ê–õ–ò–ó –ö–û–î–ê

### 1. ANCHOR CONNECTIONS - –û–¢–°–£–¢–°–¢–í–£–Æ–¢

**–§–∞–π–ª:** `protocol.rs`, —Å—Ç—Ä–æ–∫–∞ 206

```rust
// NOTE: Montana does NOT use anchor connections (see Network struct comment).
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚ùå **–ù–ï–¢ –º–µ—Ö–∞–Ω–∏–∑–º–∞ anchor connections** –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º–∏
- ‚ùå –ü–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –≤—Å–µ –∞–¥—Ä–µ—Å–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ `addresses.dat` –±–µ–∑ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏
- ‚ùå –ù–µ—Ç "trusted" –∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º–∏
- ‚ùå –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω—ã—Ö outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
–ü–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –∂–µ—Ä—Ç–≤—ã –≤—Å–µ outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –∏–∑ AddrMan –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–∏, —á—Ç–æ –æ–Ω–∏ –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç—Å—è –∞—Ç–∞–∫—É—é—â–∏–º.

### 2. NETGROUP DIVERSITY - –ù–ï–î–û–°–¢–ê–¢–û–ß–ù–ê –î–õ–Ø OUTBOUND

**–§–∞–π–ª—ã:** `connection.rs`, `protocol.rs`, `addrman.rs`

**–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:**

```517:519:Montana ACP/montana/src/net/protocol.rs
// Check netgroup diversity
if !connections.can_connect(&socket_addr).await {
    continue;
```

```264:270:Montana ACP/montana/src/net/connection.rs
/// Check if we can connect to this address (netgroup diversity)
pub async fn can_connect(&self, addr: &SocketAddr) -> bool {
    let netgroup = get_netgroup(addr);
    let counts = self.netgroup_counts.lock().await;
    let current = counts.get(&netgroup).copied().unwrap_or(0);
    current < MAX_PEERS_PER_NETGROUP
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚úÖ Netgroup diversity –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **–ü–û–°–õ–ï** –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞ –∏–∑ AddrMan
- ‚ùå `select()` –≤ AddrMan **–ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç** –≤—ã–±–æ—Ä –∏–∑ —Ä–∞–∑–Ω—ã—Ö netgroups
- ‚ùå `select_from_new()` –∏ `select_from_tried()` –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ª—É—á–∞–π–Ω—ã–π bucket –≤—ã–±–æ—Ä
- ‚ùå –ï—Å–ª–∏ NEW table –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –∞–¥—Ä–µ—Å–∞–º–∏ –∏–∑ 4-—Ö /16 –ø–æ–¥—Å–µ—Ç–µ–π –∞—Ç–∞–∫—É—é—â–µ–≥–æ, –≤—Å–µ 8 outbound –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑ —ç—Ç–∏—Ö –ø–æ–¥—Å–µ—Ç–µ–π

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
MAX_PEERS_PER_NETGROUP=2 –∑–∞—â–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞, –Ω–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–¥—Ä–µ—Å–æ–≤.

### 3. BUCKET COLLISION HANDLING - –£–Ø–ó–í–ò–ú–û–°–¢–¨

**–§–∞–π–ª:** `addrman.rs`, —Å—Ç—Ä–æ–∫–∏ 201-208

```201:208:Montana ACP/montana/src/net/addrman.rs
// Handle collision
if let Some(existing_idx) = self.tried_table[idx] {
    // Move existing back to new
    self.move_to_new(existing_idx);
}

self.tried_table[idx] = Some(addr_idx);
self.tried_count += 1;
```

**–ê–Ω–∞–ª–∏–∑:**
- –ü—Ä–∏ `mark_good()` –µ—Å–ª–∏ bucket –∑–∞–Ω—è—Ç, —Å—Ç–∞—Ä—ã–π –∞–¥—Ä–µ—Å –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ NEW table
- –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –¥–ª—è:
  1. –í—ã—Ç–µ—Å–Ω–µ–Ω–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ TRIED table
  2. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏—è TRIED table —Å–≤–æ–∏–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ —á–µ—Ä–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ `mark_good()` –≤—ã–∑–æ–≤—ã

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
–ö–æ–ª–ª–∏–∑–∏–∏ –≤ TRIED table –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤.

### 4. –ó–ê–ü–û–õ–ù–ï–ù–ò–ï NEW TABLE - –ë–ï–ó –ó–ê–©–ò–¢–´

**–§–∞–π–ª:** `addrman.rs`, —Å—Ç—Ä–æ–∫–∏ 408-416

```408:416:Montana ACP/montana/src/net/addrman.rs
/// Add multiple addresses (from addr message)
pub fn add_many(&mut self, addrs: Vec<NetAddress>, source: SocketAddr) -> usize {
    let mut added = 0;
    for addr in addrs {
        if self.add(addr, Some(source)) {
            added += 1;
        }
    }
    added
}
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚ùå –ù–µ—Ç rate limiting –Ω–∞ `add_many()`
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è netgroups –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏
- ‚ùå –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 1000 –∞–¥—Ä–µ—Å–æ–≤ –∑–∞ —Ä–∞–∑ (MAX_ADDR_SIZE)
- ‚ùå NEW table: 1024 buckets √ó 64 slots = 65,536 –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
–ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å NEW table –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ Addr —Å–æ–æ–±—â–µ–Ω–∏—è.

### 5. –í–´–ë–û–† –ê–î–†–ï–°–û–í - –°–õ–£–ß–ê–ô–ù–´–ô, –ë–ï–ó –ì–ê–†–ê–ù–¢–ò–ô

**–§–∞–π–ª:** `addrman.rs`, —Å—Ç—Ä–æ–∫–∏ 230-245

```230:245:Montana ACP/montana/src/net/addrman.rs
fn select_inner(&mut self, new_only: bool) -> Option<NetAddress> {
    let mut rng = ChaCha20Rng::from_entropy();

    // 50% chance to try new address (or 100% if new_only)
    let use_new = new_only || rng.gen_bool(0.5);

    if use_new && self.new_count > 0 {
        self.select_from_new(&mut rng)
    } else if self.tried_count > 0 {
        self.select_from_tried(&mut rng)
    } else if self.new_count > 0 {
        self.select_from_new(&mut rng)
    } else {
        None
    }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `select_from_new()` –∏ `select_from_tried()` –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä bucket
- –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –≤—ã–±–æ—Ä–∞ –∏–∑ —Ä–∞–∑–Ω—ã—Ö netgroups
- –ï—Å–ª–∏ NEW table –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –∞–¥—Ä–µ—Å–∞–º–∏ –∞—Ç–∞–∫—É—é—â–µ–≥–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –Ω–∏–∑–∫–∞

## –≠–ö–°–ü–õ–£–ê–¢–ê–¶–ò–Ø ECLIPSE ATTACK

### –§–ê–ó–ê 1: –ó–ê–ü–û–õ–ù–ï–ù–ò–ï NEW TABLE

**–¶–µ–ª—å:** –ó–∞–ø–æ–ª–Ω–∏—Ç—å NEW table –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏

**–®–∞–≥–∏:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∂–µ—Ä—Ç–≤–µ –∫–∞–∫ inbound peer
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `Addr` —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏:
   - –î–æ 1000 –∞–¥—Ä–µ—Å–æ–≤ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ (MAX_ADDR_SIZE)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ /16 –ø–æ–¥—Å–µ—Ç–∏ (–º–∏–Ω–∏–º—É–º 4 –¥–ª—è –æ–±—Ö–æ–¥–∞ MAX_PEERS_PER_NETGROUP=2)
   - –ö–∞–∂–¥—ã–π –∞–¥—Ä–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å routable (–Ω–µ private/loopback)
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å —Ä–∞–∑–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è –æ–±—Ö–æ–¥–∞ rate limiting
4. –¶–µ–ª—å: –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ buckets –≤ NEW table

**–ö–æ–¥ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:**
```rust
// –°–æ–∑–¥–∞—Ç—å 65k+ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö /16 –ø–æ–¥—Å–µ—Ç—è—Ö
let mut malicious_addrs = Vec::new();
for subnet in 0..4 {  // 4 —Ä–∞–∑–Ω—ã–µ /16 –ø–æ–¥—Å–µ—Ç–∏
    for i in 0..16384 {  // 16k –∞–¥—Ä–µ—Å–æ–≤ –Ω–∞ –ø–æ–¥—Å–µ—Ç—å
        let ip = Ipv4Addr::new(
            subnet as u8,
            (i / 256) as u8,
            (i % 256) as u8,
            1
        );
        malicious_addrs.push(NetAddress::new(
            IpAddr::V4(ip),
            19333,
            NODE_FULL
        ));
    }
}

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Addr —Å–æ–æ–±—â–µ–Ω–∏—è (–ø–æ 1000 –∑–∞ —Ä–∞–∑)
for chunk in malicious_addrs.chunks(1000) {
    send_addr_message(chunk.to_vec());
}
```

### –§–ê–ó–ê 2: –ü–†–û–î–í–ò–ñ–ï–ù–ò–ï –í TRIED TABLE

**–¶–µ–ª—å:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –∏–∑ NEW –≤ TRIED table

**–®–∞–≥–∏:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 8 outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –æ—Ç –∂–µ—Ä—Ç–≤—ã –∫ –∞—Ç–∞–∫—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:
   - –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å handshake
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–º
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (slices, transactions)
3. –ñ–µ—Ä—Ç–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `mark_connected()` ‚Üí `mark_good()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
4. –ê–¥—Ä–µ—Å–∞ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –∏–∑ NEW –≤ TRIED table

**–ü—Ä–æ–±–ª–µ–º–∞ —Å bucket collisions:**
- –ï—Å–ª–∏ bucket –≤ TRIED table –∑–∞–Ω—è—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º, –æ–Ω –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ NEW
- –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å `mark_good()` –¥–ª—è –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤

### –§–ê–ó–ê 3: –û–ñ–ò–î–ê–ù–ò–ï –†–ï–°–¢–ê–†–¢–ê

**–¶–µ–ª—å:** –î–æ–∂–¥–∞—Ç—å—Å—è —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –∂–µ—Ä—Ç–≤—ã

**–®–∞–≥–∏:**
1. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∂–µ—Ä—Ç–≤—É –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Ä–µ—Å—Ç–∞—Ä—Ç–∞
3. –ü–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞:
   - AddrMan –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `addresses.dat`
   - –í—Å–µ –∞–¥—Ä–µ—Å–∞ –≤ TRIED table —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
   - Anchor connections –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç

### –§–ê–ó–ê 4: ECLIPSE –£–°–ü–ï–®–ï–ù

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
1. –ü–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ –∂–µ—Ä—Ç–≤–∞ –≤—ã–±–∏—Ä–∞–µ—Ç outbound –∞–¥—Ä–µ—Å–∞ –∏–∑ AddrMan
2. –í—Å–µ 8 outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏–¥—É—Ç –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É (–∏–∑ TRIED table)
3. –ñ–µ—Ä—Ç–≤–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π —Å–µ—Ç–∏ –∞—Ç–∞–∫—É—é—â–µ–≥–æ
4. –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç:
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
   - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ª–æ–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ chain state
   - –ü—Ä–æ–≤–æ–¥–∏—Ç—å double-spend –∞—Ç–∞–∫–∏
   - –ú–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å consensus

## –ü–†–û–í–ï–†–ö–ê –ß–ï–ö–õ–ò–°–¢–ê

–°–æ–≥–ª–∞—Å–Ω–æ —à–∞–±–ª–æ–Ω—É:

```
[ ] Eclipse: netgroup diversity —Ä–∞–±–æ—Ç–∞–µ—Ç  ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢ –¥–ª—è outbound –≤—ã–±–æ—Ä–∞
[ ] Eclipse: anchor connections –µ—Å—Ç—å      ‚ùå –û–¢–°–£–¢–°–¢–í–£–Æ–¢
[ ] Eclipse: bucket collision handling   ‚ö†Ô∏è –£–Ø–ó–í–ò–ú–û
```

## –ú–ò–¢–ò–ì–ê–¶–ò–ò –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:

1. **–î–æ–±–∞–≤–∏—Ç—å Anchor Connections:**
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å 2-3 –Ω–∞–¥–µ–∂–Ω—ã—Ö outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–µ—Å—Ç–∞—Ä—Ç–∞–º–∏
   - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è anchor –∞–¥—Ä–µ—Å–æ–≤

2. **–£–ª—É—á—à–∏—Ç—å Netgroup Diversity –¥–ª—è Outbound:**
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä –∏–∑ —Ä–∞–∑–Ω—ã—Ö netgroups –ø—Ä–∏ `select()`
   - –¢—Ä–µ–±–æ–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º 4 —Ä–∞–∑–Ω—ã—Ö /16 –ø–æ–¥—Å–µ—Ç–∏ –¥–ª—è 8 outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å diversity –î–û –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞, –∞ –Ω–µ –ø–æ—Å–ª–µ

3. **–ó–∞—â–∏—Ç–∞ –æ—Ç Bucket Collision Abuse:**
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É `mark_good()` –≤—ã–∑–æ–≤–æ–≤
   - –ó–∞—â–∏—â–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ TRIED table –æ—Ç –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è collision handling

4. **Rate Limiting –¥–ª—è Addr Messages:**
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤, –ø—Ä–∏–Ω–∏–º–∞–µ–º—ã—Ö –æ—Ç –æ–¥–Ω–æ–≥–æ peer
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ netgroups –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏
   - –¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ TRIED

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**Eclipse Attack –Ω–∞ —Å–µ—Ç—å Montana –†–ï–ê–õ–ò–ó–£–ï–ú** –∏–∑-–∑–∞:
1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏—è anchor connections
2. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π netgroup diversity –ø—Ä–∏ –≤—ã–±–æ—Ä–µ outbound –∞–¥—Ä–µ—Å–æ–≤
3. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è NEW table –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
4. –£—è–∑–≤–∏–º–æ—Å—Ç–∏ bucket collision handling –≤ TRIED table

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø**

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—à–Ω–æ–π –∞—Ç–∞–∫–∏:** –í–´–°–û–ö–ê–Ø –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (4+ /16 –ø–æ–¥—Å–µ—Ç–µ–π, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞)

**–í—Ä–µ–º—è –¥–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:** –°—Ä–µ–¥–Ω–µ–µ (—Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏ –æ–∂–∏–¥–∞–Ω–∏–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞)
