# –û—Ç—á–µ—Ç –æ–± –∞–Ω–∞–ª–∏–∑–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Eclipse Attack ‚Äî Montana Network

**–ú–æ–¥–µ–ª—å:** Composer 1  
**–ö–æ–º–ø–∞–Ω–∏—è:** Cursor  
**–î–∞—Ç–∞:** 07.01.2026 21:09 UTC

---

## –†–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Å–ª–æ—è Montana –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Eclipse Attack. –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã **5 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —É–∑–µ–ª –∂–µ—Ä—Ç–≤—ã –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –µ–≥–æ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø**

---

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: Startup Verification –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

**–§–∞–π–ª:** `Montana ACP/montana/src/net/startup.rs`

**–ü—Ä–æ–±–ª–µ–º–∞:**

–§—É–Ω–∫—Ü–∏—è `query_hardcoded_tips()` –≤ `startup.rs` —è–≤–ª—è–µ—Ç—Å—è –∑–∞–≥–ª—É—à–∫–æ–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –≤–µ–∫—Ç–æ—Ä –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

```165:179:Montana ACP/montana/src/net/startup.rs
    /// Query hardcoded nodes for their chain tips
    async fn query_hardcoded_tips(&self, addrs: &[SocketAddr]) -> Vec<PeerChainInfo> {
        // This is a simplified implementation
        // Real implementation would:
        // 1. Connect to each hardcoded node
        // 2. Complete handshake
        // 3. Get their best slice height
        // 4. Disconnect

        // For now, return empty - actual network queries would be done
        // by the Network module when it starts
        info!("Querying {} hardcoded nodes for chain tips", addrs.len());

        // Placeholder: in production, this would make actual network requests
        // The Network module handles this during start()
        Vec::new()
    }
```

**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**

1. –£–∑–µ–ª –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `verification_type()`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É "full_bootstrap"
2. –í `main.rs` –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫:

```84:90:Montana ACP/montana/src/main.rs
        let verify_type = verification_type(&storage);
        let chain_age = storage.chain_age_secs().unwrap_or(u64::MAX);
        let head = storage.head().unwrap_or(0);

        info!("Startup verification: {} (chain_age={} secs, height={})",
            verify_type, chain_age, head);
        info!("Full bootstrap: 100 peers, 25+ subnets required");
```

3. –°–µ—Ç—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. AddrMan –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `addresses.dat` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞
5. –í—Å–µ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–¥—É—Ç –∫ –∞–¥—Ä–µ—Å–∞–º –∏–∑ AddrMan, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω—ã

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ü–æ–ª–Ω—ã–π –æ–±—Ö–æ–¥ –∑–∞—â–∏—Ç—ã –æ—Ç Eclipse Attack
- –£–∑–µ–ª –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Å–µ–Ω—Å—É—Å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å `addresses.dat` –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ –∑–∞—Ä–∞–Ω–µ–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ `query_hardcoded_tips()`
2. –í—ã–∑–≤–∞—Ç—å `StartupVerifier::verify()` –≤ `main.rs` –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ç–∏

---

### 2. üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: AddrMan –º–æ–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ Addr —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

**–§–∞–π–ª:** `Montana ACP/montana/src/net/protocol.rs`

**–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ `Addr` —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π. –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏:

```984:1000:Montana ACP/montana/src/net/protocol.rs
            Message::Addr(addrs) => {
                if addrs.len() > MAX_ADDR_SIZE {
                    return Err(NetError::Protocol("Too many addresses".into()));
                }

                // Rate limit: process only allowed addresses
                let allowed = peer.rate_limits.addr.process(addrs.len());
                if allowed == 0 {
                    debug!("Rate limited addr from {}", peer.addr);
                    return Ok(false);
                }

                // Only process up to allowed count
                let to_process: Vec<_> = addrs.into_iter().take(allowed).collect();
                let added = addresses.write().await.add_many(to_process, peer.addr);
                debug!("Added {} addresses from {} (rate limited to {})", added, peer.addr, allowed);
            }
```

**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**

1. –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∂–µ—Ä—Ç–≤–µ (inbound –∏–ª–∏ outbound)
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `Addr` —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∞–¥—Ä–µ—Å–∞–º–∏ –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π
3. –ê–¥—Ä–µ—Å–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ NEW table AddrMan –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
4. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ—Å—Ç–∞—Ä—Ç–µ (–µ—Å–ª–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±–æ–π–¥–µ–Ω–∞), –≤—Å–µ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–¥—É—Ç –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ AddrMan –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
- –ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ —É–∑–µ–ª –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É
- Rate limiting –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–æ–≤
2. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
3. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–æ–¥—Å–µ—Ç–µ–π –≤ AddrMan –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º –ø–∏—Ä–æ–≤

---

### 3. üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: Netgroup diversity —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–§–∞–π–ª:** `Montana ACP/montana/src/net/connection.rs`

**–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–æ–≤–µ—Ä–∫–∞ `can_connect()` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –î–ª—è –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –Ω–æ –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ inbound –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å AddrMan:

```271:277:Montana ACP/montana/src/net/connection.rs
    /// Check if we can connect to this address (netgroup diversity)
    pub async fn can_connect(&self, addr: &SocketAddr) -> bool {
        let netgroup = get_netgroup(addr);
        let counts = self.netgroup_counts.lock().await;
        let current = counts.get(&netgroup).copied().unwrap_or(0);
        current < MAX_PEERS_PER_NETGROUP
    }
```

**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**

1. –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ inbound (–¥–æ 117 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)
2. –ö–∞–∂–¥–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö IP, –Ω–æ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ (–¥–æ 2 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–∞ –ø–æ–¥—Å–µ—Ç—å)
3. –ê—Ç–∞–∫—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `Addr` —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∞–¥—Ä–µ—Å–∞–º–∏ –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π
4. AddrMan –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
5. –ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ –≤—Å–µ outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–¥—É—Ç –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- Inbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å AddrMan –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—é
- –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ IP –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π —Ç–∞–∫–∂–µ –¥–ª—è –∞–¥—Ä–µ—Å–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ inbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
2. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ –≤ AddrMan
3. –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–æ–¥—Å–µ—Ç–µ–π –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–æ–≤ –≤ AddrMan

---

### 4. üü† –í–´–°–û–ö–ê–Ø: Bucket collision –≤ TRIED table –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –∞—Ç–∞–∫–∏

**–§–∞–π–ª:** `Montana ACP/montana/src/net/addrman.rs`

**–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏ –≤ TRIED table —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∞–¥—Ä–µ—Å –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ NEW table. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤:

```210:222:Montana ACP/montana/src/net/addrman.rs
        // Add to tried
        let bucket = self.get_tried_bucket(addr);
        let pos = self.get_bucket_position(addr, bucket, false);
        let idx = bucket * BUCKET_SIZE + pos;

        // Handle collision
        if let Some(existing_idx) = self.tried_table[idx] {
            // Move existing back to new
            self.move_to_new(existing_idx);
        }

        self.tried_table[idx] = Some(addr_idx);
        self.tried_count += 1;
    }
```

**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**

1. –ê—Ç–∞–∫—É—é—â–∏–π –≤—ã—á–∏—Å–ª—è–µ—Ç bucket –¥–ª—è –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤ TRIED table
2. –°–æ–∑–¥–∞–µ—Ç –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ç–æ—Ç –∂–µ bucket –∏ –ø–æ–∑–∏—Ü–∏—é
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —ç—Ç–∏–º –∞–¥—Ä–µ—Å–æ–º
4. –õ–µ–≥–∏—Ç–∏–º–Ω—ã–π –∞–¥—Ä–µ—Å –≤—ã—Ç–µ—Å–Ω—è–µ—Ç—Å—è –∏–∑ TRIED –≤ NEW
5. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—ã–±–æ—Ä–µ –ø–∏—Ä–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π –∞–¥—Ä–µ—Å —Å–Ω–∏–∂–∞–µ—Ç—Å—è

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –í—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ TRIED table
- –°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –≤ TRIED table
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –ü—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏ –≤ TRIED table –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∞–¥—Ä–µ—Å, –∞ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –Ω–æ–≤—ã–π
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∞–¥—Ä–µ—Å–∞)
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ –≤ TRIED

---

### 5. üü† –í–´–°–û–ö–ê–Ø: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–∏—Ä–æ–≤ –∏–∑ AddrMan

**–§–∞–π–ª:** `Montana ACP/montana/src/net/addrman.rs`

**–ü—Ä–æ–±–ª–µ–º–∞:**

–ú–µ—Ç–æ–¥ `select()` –≤—ã–±–∏—Ä–∞–µ—Ç –∞–¥—Ä–µ—Å–∞ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π:

```233:258:Montana ACP/montana/src/net/addrman.rs
    /// Select an address to connect to (50/50 new vs tried)
    pub fn select(&mut self) -> Option<NetAddress> {
        self.select_inner(false)
    }

    /// Select an address to connect to with option for new only
    pub fn select_with_option(&mut self, new_only: bool) -> Option<NetAddress> {
        self.select_inner(new_only)
    }

    fn select_inner(&mut self, new_only: bool) -> Option<NetAddress> {
        let mut rng = ChaCha20Rng::from_entropy();

        // 50% chance to try new address (or 100% if new_only)
        let use_new = new_only || rng.gen_bool(0.5);

        if use_new && self.new_count > 0 {
            self.select_from_new(&mut rng)
        } else if self.tried_count > 0 {
            self.select_from_tried(&mut rng)
        } else if self.new_count > 0 {
            self.select_from_new(&mut rng)
        } else {
            None
        }
    }
```

**–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è:**

1. –ê—Ç–∞–∫—É—é—â–∏–π –∑–∞–ø–æ–ª–Ω—è–µ—Ç AddrMan –∞–¥—Ä–µ—Å–∞–º–∏ –∏–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø–æ–¥—Å–µ—Ç–µ–π
2. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–∏—Ä–æ–≤ `select()` –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ –ø–æ–¥—Ä—è–¥
3. `can_connect()` –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
4. –ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ø–æ –ø–æ–¥—Å–µ—Ç—è–º
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ AddrMan

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –≤ `select()` –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∞–¥—Ä–µ—Å–∞
2. –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–µ—Ç–∏ –≤ —Ç–µ–∫—É—â–µ–º —Ü–∏–∫–ª–µ –≤—ã–±–æ—Ä–∞
3. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å–∞ –∏–∑ –Ω–æ–≤—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π

---

## –û–±—â–∏–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ–π Eclipse Attack:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
   - –ê—Ç–∞–∫—É—é—â–∏–π –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ `addresses.dat` –∂–µ—Ä—Ç–≤—ã (—á–µ—Ä–µ–∑ malware, –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é —Å–µ—Ä–≤–µ—Ä–∞, –∏–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Addr —Å–æ–æ–±—â–µ–Ω–∏—è)
   - –ó–∞–ø–æ–ª–Ω—è–µ—Ç NEW table –∞–¥—Ä–µ—Å–∞–º–∏ –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π (1024 buckets √ó 64 entries = –¥–æ 65,536 –∞–¥—Ä–µ—Å–æ–≤)

2. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ AddrMan:**
   - –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∂–µ—Ä—Ç–≤–µ —á–µ—Ä–µ–∑ inbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `Addr` —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∞–¥—Ä–µ—Å–∞–º–∏ –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π
   - –ê–¥—Ä–µ—Å–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ NEW table –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

3. **–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –≤ TRIED:**
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
   - –ê–¥—Ä–µ—Å–∞ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ TRIED table —á–µ—Ä–µ–∑ `mark_connected()`
   - –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã—Ç–µ—Å–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ bucket collision

4. **–†–µ—Å—Ç–∞—Ä—Ç –∂–µ—Ä—Ç–≤—ã:**
   - Startup verification –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (—É—è–∑–≤–∏–º–æ—Å—Ç—å #1)
   - AddrMan –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `addresses.dat` —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
   - –í—Å–µ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–¥—É—Ç –∫ –∞—Ç–∞–∫—É—é—â–µ–º—É

5. **–ò–∑–æ–ª—è—Ü–∏—è:**
   - –ñ–µ—Ä—Ç–≤–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω–æ–π —Å–µ—Ç–∏
   - –ê—Ç–∞–∫—É—é—â–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –ø–æ–ª—É—á–∞–µ–º—É—é –∂–µ—Ä—Ç–≤–æ–π
   - –í–æ–∑–º–æ–∂–Ω—ã –∞—Ç–∞–∫–∏ –Ω–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å, –¥–≤–æ–π–Ω–æ–µ —Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–∏–µ –∏ —Ç.–¥.

---

## –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏ –∏—Ö –æ–±—Ö–æ–¥

### –ó–∞—â–∏—Ç–∞: Full Bootstrap Verification

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ê–ë–û–¢–ê–ï–¢**

- –ö–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- `query_hardcoded_tips()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –≤–µ–∫—Ç–æ—Ä
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ —Å–µ—Ç–∏

### –ó–∞—â–∏—Ç–∞: Netgroup Diversity (MAX_PEERS_PER_NETGROUP=2)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –†–ê–ë–û–¢–ê–ï–¢**

- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è AddrMan —á–µ—Ä–µ–∑ inbound
- –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–æ–≤ –≤ AddrMan

### –ó–∞—â–∏—Ç–∞: Rate Limiting –Ω–∞ Addr —Å–æ–æ–±—â–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–ï–î–û–°–¢–ê–¢–û–ß–ù–û**

- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤ –∑–∞ —Ä–∞–∑
- –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
- –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–æ–¥—Å–µ—Ç–µ–π

### –ó–∞—â–∏—Ç–∞: Bucket System –≤ AddrMan

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–°–õ–ê–ë–ê–Ø**

- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤
- –ù–æ –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö buckets –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
- Collision handling –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π):

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é startup verification:**
   - –í—ã–ø–æ–ª–Ω—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ hardcoded nodes
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫ —Å–µ—Ç–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–Ω—Å–µ–Ω—Å—É—Å –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π AddrMan

2. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –≤ AddrMan:**
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–æ–≤
   - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å–∞ –∏–∑ –Ω–æ–≤—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π –ø—Ä–∏ –≤—ã–±–æ—Ä–µ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í—ã—Å–æ–∫–∏–π):

3. **–£–ª—É—á—à–∏—Ç—å bucket collision handling:**
   - –ù–µ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∞–¥—Ä–µ—Å–∞ –∏–∑ TRIED –ø—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è

4. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ select():**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–µ—Ç–∏
   - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å–∞ –∏–∑ –Ω–æ–≤—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–°—Ä–µ–¥–Ω–∏–π):

5. **–£—Å–∏–ª–∏—Ç—å rate limiting:**
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π –≤ rate limiter
   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ –æ–¥–Ω–æ–π –ø–æ–¥—Å–µ—Ç–∏ –æ—Ç –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

6. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –Ω–∏–∑–∫–æ–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–∏ –ø–æ–¥—Å–µ—Ç–µ–π
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è AddrMan

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–µ—Ç–µ–≤–æ–π —Å–ª–æ–π Montana —Å–æ–¥–µ—Ä–∂–∏—Ç **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å —É—Å–ø–µ—à–Ω—É—é Eclipse Attack. –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ **startup verification –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è**, —á—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ö–æ–¥–∏—Ç –∑–∞—â–∏—Ç—É –æ—Ç Eclipse Attack.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å AddrMan –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∂–µ—Ä—Ç–≤—ã.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.**

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ö–æ–¥ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

### –£—è–∑–≤–∏–º–æ—Å—Ç—å #1: Startup Verification –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

```rust
// Montana ACP/montana/src/net/startup.rs:165-179
async fn query_hardcoded_tips(&self, addrs: &[SocketAddr]) -> Vec<PeerChainInfo> {
    // Placeholder: in production, this would make actual network requests
    Vec::new()  // ‚ùå –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –≤–µ–∫—Ç–æ—Ä
}
```

### –£—è–∑–≤–∏–º–æ—Å—Ç—å #2: AddrMan –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

```rust
// Montana ACP/montana/src/net/protocol.rs:998
let added = addresses.write().await.add_many(to_process, peer.addr);
// ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –ø–æ–¥—Å–µ—Ç–µ–π
```

### –£—è–∑–≤–∏–º–æ—Å—Ç—å #3: Netgroup diversity —Ç–æ–ª—å–∫–æ –¥–ª—è outbound

```rust
// Montana ACP/montana/src/net/connection.rs:272-277
pub async fn can_connect(&self, addr: &SocketAddr) -> bool {
    // ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ outbound —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è—Ö
    // ‚ùå –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è AddrMan —á–µ—Ä–µ–∑ inbound
}
```

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞**

